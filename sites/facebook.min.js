// annyang
// version : 0.2.0
// author : Tal Ater
// license : MIT
// TalAter.com
(function(){"use strict";var e=this,t,n,r={start:[],error:[],end:[],result:[],resultMatch:[],resultNoMatch:[]},i=!1,s="font-weight: bold; color: #00f;";if(!("webkitSpeechRecognition"in e)){e.annyang=null;return null}var o=/\s*\((.*?)\)\s*/g,u=/(\(\?:[^)]+\))\?/g,a=/(\(\?)?:\w+/g,f=/\*\w+/g,l=/[\-{}\[\]+?.,\\\^$|#]/g,c=function(e){e=e.replace(l,"\\$&").replace(o,"(?:$1)?").replace(a,function(e,t){return t?e:"([^\\s]+)"}).replace(f,"(.*?)").replace(u,"\\s*$1?\\s*");return new RegExp("^"+e+"$","i")},h=function(e){for(var t=0,n=e.length;t<n;t++)e[t].apply(this)};e.annyang={init:function(o){n&&n.abort&&n.abort();n=new webkitSpeechRecognition;n.maxAlternatives=5;n.continuous=!0;n.lang="en-US";n.onstart=function(){h(r.start)};n.onerror=function(){h(r.error)};n.onend=function(){h(r.end)};n.onresult=function(n){h(r.result);var o=n.results[n.resultIndex],u;for(var a=0;a<o.length;a++){u=o[a].transcript.trim();i&&e.console.log("Speech recognized: %c"+u,s);for(var f=0,l=t.length;f<l;f++){var c=t[f].command.exec(u);if(c){var p=c.slice(1);if(i){e.console.log("command matched: %c"+t[f].originalPhrase,s);p.length&&e.console.log("with parameters",p)}t[f].callback.apply(this,p);h(r.resultMatch);return!0}}}h(r.resultNoMatch);return!1};t=[];this.addCommands(o)},start:function(){n.start()},abort:function(){n.abort()},debug:function(e){arguments.length>0?i=!!e:i=!0},setLanguage:function(e){n.lang=e},addCommands:function(n){var r,o;for(var u in n){if(!hasOwnProperty.call(n,u))continue;r=e[n[u]]||n[u];if(typeof r!="function")continue;o=c(u);t.push({command:o,callback:r,originalPhrase:u})}i&&e.console.log("Commands successfully loaded: %c"+t.length,s)},addCallback:function(t,n){if(r[t]===void 0)return;var i=e[n]||n;if(typeof i!="function")return;r[t].push(i)}}}).call(this);(function(){"use strict";var e=this;if(annyang){var t=function(){e.Chat.toggleSidebar()},n=function(){e.ChatVisibility.goOnline()},r=function(){e.ChatVisibility.goOffline()},i=function(t){e.goURI("/search/more/?q="+t)},s=function(t){e.goURI("/"+t.replace(/[^\w]/ig,""))},o=function(){e.goURI("/")},u=function(){e.goURI("/appcenter")},a=function(){e.goURI("/messages")},f=function(){e.goURI("/friends/requests")},l=function(){e.goURI("/friends")},c=function(){e.goURI("/me")},h=function(){e.goURI("/events/list")},p=function(){e.goURI("/events/calendar")},d=function(t){e.goURI("/"+(t||"me").replace(/[^\w]/ig,"")+"/photos")},v=function(t){e.goURI("/"+(t||"me").replace(/[^\w]/ig,"")+"/photos_albums")},m=function(){history.back()},g=function(e){e==="up"?window.scrollBy(0,-(window.innerHeight-$("pageHead").offsetHeight)):window.scrollBy(0,window.innerHeight-$("pageHead").offsetHeight)};annyang.init({back:m,"go back":m,"go home":o,home:o,news:o,profile:c,me:c,games:u,apps:u,messages:a,inbox:a,mail:a,email:a,events:h,calendar:p,photos:d,"photos *page":d,albums:v,"albums *page":v,"friend requests":f,friends:l,chat:t,"chat online":n,"go online":n,"chat offline":r,"go offline":r,scroll:g,"scroll :direction":g,"find *term":i,"search for *term":i,"search *term":i,"go to *page":s,"go *page":s});annyang.start()}}).call(this);